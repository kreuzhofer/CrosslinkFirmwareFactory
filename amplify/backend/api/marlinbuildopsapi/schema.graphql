type BuildDefinition @model 
  @auth(rules: [{ allow: owner }]) {
  id: ID!
  name: String!
  sourceTree: String!
  configTree: String!
  printerManufacturer: String
  printerModel: String
  printerMainboard: String
  platformioEnv: String
  description: String
  configurationJSON: String
  owner: String
  buildJobs: [BuildJob!] @connection(keyName: "byBuildDefinition", fields: ["id"])
}

type BuildJob @model 
  @auth(rules: [{ allow: owner }]) 
  @key(name: "byBuildDefinition", fields: ["buildDefinitionID", "id"])
{
  id: ID!
  buildDefinitionID: ID!
  jobState: BuildJobState!
  startTime: String
  endTime: String
  message: String
  log: String
  buildJobArtifacts: [BuildJobArtifact!] @connection(keyName: "byBuildJob", fields: ["id"])
}

type BuildJobArtifact @model
  @auth(rules: [{allow: owner}])
  @key(name: "byBuildJob", fields: ["buildJobID", "id"])
{
  id: ID!
  buildJobID: ID!
  artifactName: String!
  artifactUrl: String!
}

enum BuildJobState {
  QUEUED
  STARTING
  RUNNING
  DONE
  FAILED
}

type Patron @model 
  @auth(rules: [{ allow: owner }]) {
  id: ID!
  email: String
  full_name: String
  patron_status: String
  last_event: String
  access_expires_at: String
  campaign_currency: String
  campaign_lifetime_support_cents: Int
  currently_entitled_amount_cents: Int
  last_charge_date: String
  last_charge_status: String
  lifetime_support_cents: Int
  will_pay_amount_cents: Int
  pledge_relationship_start: String
}

type PatronActivityLog @model 
  @auth(rules: [{ allow: owner }]) {
  id: ID!
  patron_event: String
  event_timestamp: String
  body: String
}